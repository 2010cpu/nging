App.select2={i18n:{TAG_INPUT:"请输入或选择标签，如有多个用空格隔开",TAG_SELECT:"请输入关键词后从搜索列表中选择",SELECT:"请选择"},tags:function(t,e,a,n,l){if(e==null)e=$(t).data("tags")||[];if(a==null)a=$(t).data("url");if(n==null)n=$(t).data("sortable")||false;if(l==null)l=$(t).data("onlyselect")||false;var r=$(t).data("single")||false;if(r)r=App.parseBool(r);var s={multiple:!r,width:"100%"};if(l){s.minimumInputLength=1;s.placeholder=App.select2.i18n.TAG_SELECT;s.data=e;s.tags=true}else{s.placeholder=App.select2.i18n.TAG_INPUT;s.tags=e;s.tokenSeparators=[","," "]}if(a){switch(typeof a){case"string":var i=$(t).data("listkey")||"list";s.query=App.select2.buildQueryFunction(a,{},i);break;default:if($.isArray(a)){var i=a.length>2?a[2]:$(t).data("listkey")||"list";s.query=App.select2.buildQueryFunction(a[0],a.length>1?a[1]:{},i);break}s.ajax=a;break}}if(!l){if(typeof s.query!="undefined"){s.query({term:"",callback:function(e){s.tags=[];for(var t=0;t<e.results.length;t++){var a=e.results[t].text;s.tags.push({id:a,text:a})}}});delete s.query}if(typeof s.ajax!="undefined"){var u=1;$.ajax(s.ajax.url,{dataType:s.ajax.dataType||"json",data:s.ajax.data("",u),async:false}).done(function(e){e=s.ajax.results(e,u);s.tags=[];for(var t=0;t<e.results.length;t++){var a=e.results[t].text;s.tags.push({id:a,text:a})}});delete s.ajax}}var o=$(t).select2(s);$(t).data("select2",o);var d=$(t).data("init");if(d)$(t).val(d.split(",")).trigger("change");if(!n)return;$(t).on("change",function(){var e;if(typeof t=="string"&&t.indexOf("#")===0){e=t+"_val"}else{e=$(t).attr("id")+"_val"}$(e).html($(t).val())});$(t).select2("container").find("ul.select2-choices").sortable({containment:"parent",start:function(){$(t).select2("onSortStart")},update:function(){$(t).select2("onSortEnd")}})},select:function(e,t){var a={placeholder:App.select2.i18n.SELECT,width:"100%",minimumInputLength:3};t=$.extend({},a,t||{});var n=$(e).select2(t);$(e).data("select2",n)},update:function(e,t){$(e).select2("data",t)},enable:function(e,t){$(e).prop("disabled",!t)},readonly:function(e,t){$(e).prop("disabled",t)},buildQueryFunction:function(e,t,n){if(n==null)n="list";return function(a){t.q=a.term;t.select2=1;$.ajax(e,{dataType:"json",data:t,async:false}).done(function(e){if(e.Code!=1){App.message({title:App.i18n.SYS_INFO,text:e.Info,type:"error"},false);return}var t={results:e.Data[n]};a.callback(t)})}},buildAjaxOptions:function(e,a,l){if(l==null)l="list";var t={url:"",dataType:"json",quietMillis:250,data:function(e,t){return $.extend({},{q:e,page:t,select2:1},a||{})},results:function(e,t){if(e.Code!=1){App.message({title:App.i18n.SYS_INFO,text:e.Info,type:"error"},false);return{results:[],more:false}}var a=e.Data;var n=t<a.pagination.pages;return{results:a[l],more:n}}};return $.extend({},t,e||{})}};